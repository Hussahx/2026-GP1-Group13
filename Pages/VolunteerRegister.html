<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#F5EFE6" />

<title>راصد — تسحيل متطوع</title>
  <!-- Google Fonts: Tajawal -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

  <style>
    /* ================================================================
       DESIGN TOKENS
       ================================================================ */
    :root {
      --primary:        #A67C52;
      --primary-light:  #C2A477;
      --secondary:      #8B6B47;
      --accent:         #7A5C38;
      --hover:          #9C7A4F;

      --bg:             #F5EFE6;
      --bg-deep:        #EDE4D3;
      --bg-card:        rgba(255, 252, 246, 0.94);
      --bg-input:       rgba(245, 239, 230, 0.80);
      --bg-input-focus: #FFFFFF;

      --text:           #3E2F1C;
      --text-mid:       #5C4530;
      --text-muted:     #7A6245;

      --border:         rgba(166, 124, 82, 0.26);
      --border-hover:   rgba(166, 124, 82, 0.45);
      --border-focus:   rgba(166, 124, 82, 0.65);

      --shadow:         0 8px 32px rgba(62, 47, 28, 0.09);
      --shadow-lg:      0 20px 64px rgba(62, 47, 28, 0.14);
      --shadow-btn:     0 4px 18px rgba(139, 107, 71, 0.28);
      --shadow-btn-hov: 0 8px 28px rgba(139, 107, 71, 0.38);

      --glass-border:   rgba(255, 248, 235, 0.70);

      --error:          #9B3A3A;
      --error-bg:       rgba(155, 58, 58, 0.07);
      --error-border:   rgba(155, 58, 58, 0.50);

      --success:        #3D7A5A;

      --radius-xs:      6px;
      --radius-sm:      10px;
      --radius-md:      16px;
      --radius-lg:      22px;
      --radius-xl:      32px;

      --font:           'Tajawal', sans-serif;
      --ease:           cubic-bezier(0.4, 0, 0.2, 1);
      --transition:     all 0.27s var(--ease);

      /* ── Unified field width ── */
      --field-max:      520px;
    }

    /* ================================================================
       RESET & BASE
       ================================================================ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    html {
      font-size: 16px;
      scroll-behavior: smooth;
      overflow-x: hidden;
    }

    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      direction: rtl;
      text-align: right;
      min-height: 100vh;
      line-height: 1.7;
      overflow-x: hidden;
      -webkit-text-size-adjust: 100%;
      display: flex;
      flex-direction: column;
      /* desert texture */
      background-image:
        radial-gradient(ellipse at 12% 18%, rgba(194,164,119,0.14) 0%, transparent 52%),
        radial-gradient(ellipse at 88% 82%, rgba(139,107,71,0.08) 0%, transparent 50%),
        repeating-linear-gradient(
          45deg, transparent, transparent 38px,
          rgba(166,124,82,0.032) 38px, rgba(166,124,82,0.032) 39px
        );
    }

    img { max-width: 100%; display: block; }
    a { color: var(--primary); text-decoration: none; transition: var(--transition); }
    a:hover { color: var(--secondary); }
    ul, ol { list-style: none; }
    button { cursor: pointer; font-family: var(--font); border: none; outline: none; }
    input, select, textarea, button { font-family: var(--font); }

    /* ================================================================
       ACCESSIBILITY
       ================================================================ */
    .sr-only {
      position: absolute;
      width: 1px; height: 1px;
      padding: 0; margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      white-space: nowrap;
      border: 0;
    }

    :focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 3px;
      border-radius: 3px;
    }

    /* ================================================================
       PAGE HEADER (full-width, flat top, curved bottom corners)
       ================================================================ */
 .page-header {
  position: relative;
  width: 100%;
  background: linear-gradient(138deg, var(--secondary) 0%, var(--accent) 100%);
  padding: clamp(1.1rem, 3.5vw, 1.75rem) clamp(1.25rem, 4vw, 2rem);
  display: flex;
  align-items: center;
  gap: 0.875rem;
  overflow: visible;
  border-radius: 0 0 clamp(22px, 5vw, 38px) clamp(22px, 5vw, 38px);
  margin-bottom: 0;
  z-index: 10;
}

    .page-header::before {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      border-radius: inherit;
      background-image:
        radial-gradient(ellipse at 80% 40%, rgba(255,255,255,0.07) 0%, transparent 58%),
        repeating-linear-gradient(
          45deg, transparent, transparent 28px,
          rgba(255,255,255,0.03) 28px, rgba(255,255,255,0.03) 29px
        );
    }

    /* ================================================================
       PAGE WRAPPER
       ================================================================ */
    .page-wrap {
      flex: 1;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: clamp(1.25rem, 4vw, 2.5rem) clamp(1rem, 3vw, 1.5rem) 3rem;
    }

    /* ================================================================
       MAIN CARD
       ================================================================ */
    .main-card {
      width: 100%;
      max-width: 660px;
      background: var(--bg-card);
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      animation: cardReveal 0.55s cubic-bezier(0.22, 1, 0.36, 1) both;
    }

    @keyframes cardReveal {
      from { opacity: 0; transform: translateY(30px) scale(0.975); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    /* ================================================================
       CITY DROPDOWN WRAPPER – constrained width
       ================================================================ */
    .city-group {
      max-width: 580px;
      width: 100%;
    }

    @media (max-width: 540px) {
      .city-group { max-width: 100%; }
    }

    /* Brand elements used in page-header */
    .brand-badge {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      position: relative;
      z-index: 1;
    }

    .brand-badge img {
      width: clamp(42px, 7vw, 52px);
      height: clamp(42px, 7vw, 52px);
      object-fit: cover;
      border-radius: var(--radius-md);
    }

    .brand-text {
      position: relative;
      z-index: 1;
      min-width: 0;
    }

    .brand-text h1 {
      font-size: clamp(1.25rem, 3.2vw, 1.65rem);
      font-weight: 900;
      color: #fff;
      line-height: 1.15;
      letter-spacing: -0.2px;
    }

    .brand-text p {
      font-size: clamp(0.78rem, 1.4vw, 0.88rem);
      color: rgba(255,255,255,0.70);
      margin-top: 2px;
      white-space: nowrap;
    }

    /* ================================================================
       CARD BODY
       ================================================================ */
    .card-body {
      padding: clamp(1.25rem, 4vw, 2rem) clamp(1.1rem, 4vw, 2rem);
    }

    /* ================================================================
       STEPPER
       ================================================================ */
    .stepper {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 0;
      margin-bottom: clamp(1.5rem, 3.5vw, 2rem);
      position: relative;
    }

    .step-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
      position: relative;
    }

    /* Connecting line */
    .step-item:not(:last-child)::after {
      content: '';
      position: absolute;
      top: 21px;
      left: 0;
      width: 100%;
      height: 2px;
      background: var(--border);
      transform: translateX(-50%);
      z-index: 0;
      transition: background 0.4s ease;
    }

    .step-item.completed:not(:last-child)::after {
      background: linear-gradient(90deg, var(--primary-light), var(--primary));
    }

    .step-circle {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 2px solid var(--border);
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.92rem;
      color: var(--text-muted);
      font-weight: 700;
      transition: var(--transition);
      position: relative;
      z-index: 1;
      flex-shrink: 0;
    }

    .step-item.active .step-circle {
      border-color: var(--primary);
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff;
      box-shadow: 0 4px 16px rgba(166,124,82,0.38);
      transform: scale(1.1);
    }

    .step-item.completed .step-circle {
      border-color: var(--primary-light);
      background: linear-gradient(135deg, var(--primary-light), var(--primary));
      color: #fff;
      transform: scale(1);
    }

    .step-label {
      margin-top: 0.45rem;
      font-size: clamp(0.65rem, 1.1vw, 0.74rem);
      color: var(--text-muted);
      font-weight: 500;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 72px;
    }

    .step-item.active   .step-label { color: var(--primary);       font-weight: 700; }
    .step-item.completed .step-label { color: var(--primary-light); font-weight: 600; }

    /* ================================================================
       STEP COUNTER
       ================================================================ */
    .step-counter {
      text-align: center;
      margin-bottom: 1.1rem;
    }

    .step-counter-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      background: rgba(166,124,82,0.09);
      border: 1px solid var(--border);
      color: var(--primary);
      padding: 0.28rem 0.9rem;
      border-radius: 50px;
      font-size: 0.78rem;
      font-weight: 700;
    }

    /* ================================================================
       STEP PANELS
       ================================================================ */
    .step-panel {
      display: none;
    }

    .step-panel.active {
      display: block;
      animation: panelIn 0.32s cubic-bezier(0.22, 1, 0.36, 1) both;
    }

    @keyframes panelIn {
      from { opacity: 0; transform: translateX(-14px); }
      to   { opacity: 1; transform: translateX(0); }
    }

    .step-title {
      font-size: clamp(1.05rem, 2.4vw, 1.22rem);
      font-weight: 800;
      color: var(--text);
      margin-bottom: 0.25rem;
    }

    .step-subtitle {
      font-size: clamp(0.8rem, 1.3vw, 0.88rem);
      color: var(--text-muted);
      margin-bottom: 1.25rem;
      line-height: 1.6;
    }

    /* ================================================================
       FORM LAYOUT
       ================================================================ */
    .form-grid {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.875rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    .form-group label,
    .field-label {
      font-size: clamp(0.8rem, 1.2vw, 0.88rem);
      font-weight: 700;
      color: var(--text-mid);
    }

    .opt-badge {
      font-weight: 400;
      font-size: 0.74rem;
      color: var(--text-muted);
      margin-inline-start: 4px;
    }

    .req-star {
      color: var(--error);
      margin-inline-start: 2px;
    }

    /* ================================================================
       INPUTS
       ================================================================ */
    .form-input,
    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="tel"],
    .form-group input[type="date"],
    .form-group select {
      width: 100%;
      height: 46px;
      padding: 0 0.9rem;
      border: 1.5px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-input);
      color: var(--text);
      font-family: var(--font);
      font-size: 0.93rem;
      direction: rtl;
      transition: var(--transition);
      outline: none;
      appearance: none;
      -webkit-appearance: none;
    }

    .form-group input[type="text"]:hover,
    .form-group input[type="email"]:hover,
    .form-group input[type="tel"]:hover,
    .form-group input[type="date"]:hover,
    .form-group select:hover {
      border-color: var(--border-hover);
    }

    .form-group input:focus,
    .form-group select:focus {
      border-color: var(--border-focus);
      background: var(--bg-input-focus);
      box-shadow: 0 0 0 3px rgba(166,124,82,0.11);
    }

    /* LTR fields */
    .ltr { direction: ltr; text-align: left; }

    /* Select custom arrow */
    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7' viewBox='0 0 11 7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%23A67C52' stroke-width='1.6' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: left 0.9rem center;
      padding-left: 2.2rem;
      cursor: pointer;
    }

    /* Invalid state */
    .form-group input.is-invalid,
    .form-group select.is-invalid {
      border-color: var(--error-border) !important;
      background: var(--error-bg);
      box-shadow: 0 0 0 3px rgba(155,58,58,0.07);
    }

    .field-error {
      display: block;
      font-size: 0.76rem;
      color: var(--error);
      min-height: 1.1em;
      line-height: 1.4;
    }

    .field-hint {
      font-size: 0.74rem;
      color: var(--text-muted);
      line-height: 1.45;
    }

    /* ================================================================
       FILE UPLOAD
       ================================================================ */
    .file-wrap { position: relative; }

    .file-label {
      display: flex;
      align-items: center;
      gap: 0.55rem;
      height: 46px;
      padding: 0 0.9rem;
      border: 1.5px dashed var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-input);
      color: var(--text-muted);
      font-size: 0.88rem;
      cursor: pointer;
      transition: var(--transition);
      overflow: hidden;
    }

    .file-label:hover {
      border-color: var(--primary);
      color: var(--primary);
      background: rgba(166,124,82,0.06);
    }

    .file-label i { flex-shrink: 0; font-size: 0.95rem; }

    .file-name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 0.83rem;
    }

    input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    /* ================================================================
       CHECKBOXES & RADIOS
       ================================================================ */
    .check-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.45rem;
    }

    .check-item {
      display: flex;
      align-items: center;
      gap: 0.55rem;
      padding: 0.55rem 0.7rem;
      border: 1.5px solid var(--border);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: var(--transition);
      background: var(--bg-input);
      user-select: none;
    }

    .check-item:hover { border-color: var(--border-hover); }

    .check-item input[type="checkbox"],
    .check-item input[type="radio"] {
      width: 16px;
      height: 16px;
      accent-color: var(--primary);
      flex-shrink: 0;
      cursor: pointer;
    }

    .check-item span {
      font-size: clamp(0.82rem, 1.3vw, 0.9rem);
      color: var(--text-mid);
      line-height: 1.3;
    }

    .check-item:has(input:checked) {
      border-color: var(--primary);
      background: rgba(166,124,82,0.09);
    }

    .check-item:has(input:checked) span { color: var(--primary); font-weight: 600; }

    /* Days pills */
    .days-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.4rem;
    }

    .day-chip {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.25rem;
      padding: 0.38rem 0.25rem;
      border: 1.5px solid var(--border);
      border-radius: 50px;
      cursor: pointer;
      transition: var(--transition);
      background: var(--bg-input);
      font-size: clamp(0.72rem, 1.2vw, 0.8rem);
      color: var(--text-muted);
      user-select: none;
    }

    .day-chip input[type="checkbox"] {
      width: 13px; height: 13px;
      accent-color: var(--primary);
      flex-shrink: 0;
    }

    .day-chip:has(input:checked) {
      border-color: var(--primary);
      background: rgba(166,124,82,0.10);
      color: var(--primary);
      font-weight: 700;
    }

    .day-chip:hover { border-color: var(--primary-light); color: var(--primary); }

    /* ================================================================
       CONSENT ITEMS (Step 4)
       ================================================================ */
    .consent-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.85rem 0.9rem;
      border: 1.5px solid var(--border);
      border-radius: var(--radius-md);
      background: var(--bg-input);
      cursor: pointer;
      transition: var(--transition);
    }

    .consent-item:hover { border-color: var(--border-hover); }

    .consent-item input[type="checkbox"] {
      width: 17px; height: 17px;
      accent-color: var(--primary);
      flex-shrink: 0;
      margin-top: 3px;
      cursor: pointer;
    }

    .consent-item span {
      font-size: clamp(0.84rem, 1.3vw, 0.9rem);
      color: var(--text-mid);
      line-height: 1.65;
    }

    .consent-item:has(input:checked) {
      border-color: var(--primary);
      background: rgba(166,124,82,0.07);
    }

    .consent-item.is-invalid { border-color: var(--error-border); background: var(--error-bg); }

    /* ================================================================
       CONSENT ITEM FIX – checkbox fully inside pill, RTL-correct
       ================================================================ */
    .consent-item {
      /* Use centre-align so checkbox never floats outside */
      align-items: center !important;
      /* Generous padding on both sides, RTL: right = text side, left = checkbox side */
      padding: 0.9rem 1rem 0.9rem 1.1rem !important;
      gap: 0.85rem !important;
      /* Prevent content from escaping rounded corners */
      overflow: hidden;
      /* Ensure label fills full field width so click area is correct */
      width: 100%;
      box-sizing: border-box;
    }

    .consent-item input[type="checkbox"] {
      /* Larger, square hit area */
      width: 19px !important;
      height: 19px !important;
      min-width: 19px;
      min-height: 19px;
      /* Remove the manual top offset – centre-align handles it */
      margin-top: 0 !important;
      margin-inline-end: 0 !important;
      flex-shrink: 0 !important;
      accent-color: var(--primary);
      cursor: pointer;
      /* Keep it on the left side in RTL (visually inside the pill) */
      order: 2;
      border-radius: 4px;
    }

    /* Text goes to the right in RTL */
    .consent-item > span {
      order: 1;
      flex: 1;
      line-height: 1.6;
    }

    /* Checked state – slight left border accent */
    .consent-item:has(input:checked) {
      border-color: var(--primary) !important;
      background: rgba(166,124,82,0.08) !important;
      border-right-width: 3px;
    }

    /* ================================================================
       SUMMARY BOX (Step 4)
       ================================================================ */
    .summary-box {
      background: rgba(166,124,82,0.055);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 0.875rem 1rem;
      margin-bottom: 1.1rem;
    }

    .summary-title {
      font-size: 0.82rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.6rem;
      display: flex;
      align-items: center;
      gap: 0.35rem;
    }

    .summary-row {
      display: flex;
      gap: 0.4rem;
      padding: 0.28rem 0;
      border-bottom: 1px solid rgba(166,124,82,0.09);
      font-size: 0.85rem;
      flex-wrap: wrap;
    }

    .summary-row:last-child { border-bottom: none; }

    .s-key {
      color: var(--text-muted);
      font-weight: 600;
      min-width: 105px;
      flex-shrink: 0;
    }

    .s-val {
      color: var(--text);
      font-weight: 500;
      flex: 1;
      word-break: break-word;
      min-width: 0;
    }

    /* ================================================================
       SECTION DIVIDER
       ================================================================ */
    .divider {
      height: 1px;
      background: var(--border);
      margin: 0.6rem 0;
      opacity: 0.6;
    }

    /* ================================================================
       NAVIGATION BUTTONS
       ================================================================ */
    .form-nav {
      display: flex;
      gap: 0.65rem;
      margin-top: 1.5rem;
      align-items: center;
    }

    .btn-prev {
      flex: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      height: 48px;
      border-radius: 50px;
      font-family: var(--font);
      font-size: clamp(0.86rem, 1.4vw, 0.94rem);
      font-weight: 700;
      border: 2px solid var(--border);
      background: transparent;
      color: var(--text-mid);
      transition: var(--transition);
      cursor: pointer;
    }

    .btn-prev:hover:not(:disabled) {
      border-color: var(--primary);
      color: var(--primary);
      background: rgba(166,124,82,0.06);
    }

    .btn-prev:disabled {
      opacity: 0.35;
      cursor: not-allowed;
    }

    .btn-next {
      flex: 1.6;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      height: 48px;
      border-radius: 50px;
      font-family: var(--font);
      font-size: clamp(0.86rem, 1.4vw, 0.94rem);
      font-weight: 700;
      border: none;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff;
      transition: var(--transition);
      box-shadow: var(--shadow-btn);
      cursor: pointer;
    }

    .btn-next:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-btn-hov);
      background: linear-gradient(135deg, var(--hover), var(--accent));
    }

    .btn-next:active { transform: translateY(0); box-shadow: var(--shadow-btn); }

    /* ================================================================
       SUCCESS PANEL
       ================================================================ */


   .success-panel {
  display: none;
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding: clamp(2rem, 7vw, 3.5rem) clamp(1.25rem, 5vw, 2.5rem);
  border-radius: 14px;
  border: 1px solid rgba(122,154,122,0.26);
  background: linear-gradient(135deg, rgba(122,154,122,0.18), rgba(74,122,86,0.10));
  gap: 1rem;
}

.success-panel.visible {
  display: flex;
  animation: successIn 0.5s cubic-bezier(0.22, 1, 0.36, 1) both;
}

.success-icon {
  width: clamp(70px, 12vw, 88px);
  height: clamp(70px, 12vw, 88px);
  border-radius: 14px; /* بدل الـ50% عشان نفس الكود القديم */
  background: linear-gradient(135deg, #7A9A7A, #4A7A56);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: clamp(1.75rem, 4vw, 2.3rem);
  margin-bottom: 1.4rem;
  box-shadow: 0 10px 22px rgba(74,122,86,0.20);
  animation: iconBounce 0.55s 0.25s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}

@keyframes successIn {
  from { opacity: 0; transform: scale(0.88); }
  to   { opacity: 1; transform: scale(1); }
}

@keyframes iconBounce {
  from { transform: scale(0.4); opacity: 0; }
  to   { transform: scale(1);   opacity: 1; }
}

.success-title {
  font-size: clamp(1.15rem, 3vw, 1.55rem);
  font-weight: 900;
  color: var(--text);
  margin-bottom: 0.6rem;
}

.success-msg {
  font-size: clamp(0.85rem, 1.5vw, 0.98rem);
  color: var(--text-muted);
  max-width: 400px;
  line-height: 1.85;
  margin-bottom: 1.75rem;
}

    .btn-home {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      height: 48px;
      padding: 0 1.75rem;
      border-radius: 50px;
      font-family: var(--font);
      font-size: 0.96rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff;
      border: none;
      cursor: pointer;
      text-decoration: none;
      box-shadow: var(--shadow-btn);
      transition: var(--transition);
    }

    .btn-home:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-btn-hov);
      color: #fff;
    }

    /* ================================================================
       RESPONSIVE
       ================================================================ */
    @media (max-width: 540px) {
      .form-row      { grid-template-columns: 1fr; }
      .check-grid    { grid-template-columns: 1fr; }
      .days-grid     { grid-template-columns: repeat(4, 1fr); }
      .step-label    { display: none; }
      .step-circle   { width: 36px; height: 36px; font-size: 0.82rem; }
      .step-item::after { top: 18px; }
      .s-key         { min-width: 85px; }
    }

    @media (max-width: 360px) {
      .days-grid { grid-template-columns: repeat(3, 1fr); }
    }

    @media (min-width: 700px) {
      .page-wrap { padding-top: 1.5rem; }
    }

    /* ================================================================
       CUSTOM CITY DROPDOWN – Premium RTL searchable
       ================================================================ */

    /* Hide the native select */
    #city { display: none !important; }

    .custom-dropdown {
      position: relative;
      width: 100%;
      font-family: var(--font);
      direction: rtl;
    }

    /* The trigger button */
    .cd-trigger {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      height: 46px;
      padding: 0 0.9rem;
      border: 1.5px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-input);
      color: var(--text-muted);
      font-family: var(--font);
      font-size: 0.93rem;
      cursor: pointer;
      transition: var(--transition);
      outline: none;
      user-select: none;
      text-align: right;
    }

    .cd-trigger:hover {
      border-color: var(--border-hover);
    }

    .cd-trigger:focus,
    .cd-trigger.open {
      border-color: var(--border-focus);
      background: var(--bg-input-focus);
      box-shadow: 0 0 0 3px rgba(166,124,82,0.11);
    }

    .cd-trigger.has-value {
      color: var(--text);
    }

    .cd-trigger.is-invalid {
      border-color: var(--error-border) !important;
      background: var(--error-bg);
      box-shadow: 0 0 0 3px rgba(155,58,58,0.07);
    }

    .cd-trigger-text {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .cd-arrow {
      flex-shrink: 0;
      margin-right: 0.5rem;
      color: var(--primary);
      font-size: 0.72rem;
      transition: transform 0.22s var(--ease);
    }

    .cd-trigger.open .cd-arrow {
      transform: rotate(180deg);
    }

    /* The dropdown panel */
    .cd-panel {
      display: none;
      position: absolute;
      top: calc(100% + 5px);
      right: 0;
      left: 0;
      z-index: 9999;
      background: #fff;
      border: 1.5px solid var(--border-hover);
      border-radius: var(--radius-md);
      box-shadow: 0 12px 40px rgba(62,47,28,0.14), 0 2px 8px rgba(62,47,28,0.06);
      overflow: hidden;
      animation: cdSlideIn 0.18s cubic-bezier(0.22,1,0.36,1) both;
    }

    .cd-panel.open {
      display: block;
    }

    @keyframes cdSlideIn {
      from { opacity: 0; transform: translateY(-6px) scaleY(0.96); }
      to   { opacity: 1; transform: translateY(0) scaleY(1); }
    }

    /* Search input inside panel */
    .cd-search-wrap {
      padding: 0.55rem 0.7rem;
      border-bottom: 1px solid var(--border);
      background: rgba(245,239,230,0.5);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .cd-search-icon {
      color: var(--text-muted);
      font-size: 0.8rem;
      flex-shrink: 0;
    }

    .cd-search {
      flex: 1;
      border: none;
      outline: none;
      background: transparent;
      font-family: var(--font);
      font-size: 0.88rem;
      color: var(--text);
      direction: rtl;
      text-align: right;
    }

    .cd-search::placeholder {
      color: var(--text-muted);
    }

    /* Options list */
    .cd-list {
      max-height: 240px;
      overflow-y: auto;
      overscroll-behavior: contain;
      padding: 0.3rem 0;
    }

    /* Scrollbar styling */
    .cd-list::-webkit-scrollbar { width: 4px; }
    .cd-list::-webkit-scrollbar-track { background: transparent; }
    .cd-list::-webkit-scrollbar-thumb {
      background: rgba(166,124,82,0.28);
      border-radius: 4px;
    }

    .cd-option {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.6rem 0.9rem;
      font-size: 0.91rem;
      color: var(--text-mid);
      cursor: pointer;
      transition: background 0.13s ease, color 0.13s ease;
      border-radius: 0;
      direction: rtl;
      text-align: right;
    }

    .cd-option:hover,
    .cd-option.focused {
      background: rgba(166,124,82,0.09);
      color: var(--primary);
    }

    .cd-option.selected {
      background: rgba(166,124,82,0.13);
      color: var(--secondary);
      font-weight: 700;
    }

    .cd-option.selected::after {
      content: '\f00c';
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      font-size: 0.72rem;
      color: var(--primary);
      margin-right: auto;
      padding-right: 0.5rem;
    }

    .cd-no-results {
      padding: 0.85rem 0.9rem;
      font-size: 0.88rem;
      color: var(--text-muted);
      text-align: center;
    }

    /* Ensure panel doesn't go off screen on mobile */
    @media (max-width: 540px) {
      .cd-panel {
        right: 0;
        left: 0;
      }
    }

    /* ================================================================
       DROPDOWN OVERRIDES – v2: no search, compact, opens UP
       ================================================================ */

    /* 1) Hide search completely */
    .cd-search-wrap {
      display: none !important;
    }

    /* 2) Constrain dropdown width & center it */
    .city-group {
      max-width: 520px !important;
      width: 100% !important;
    }

    .custom-dropdown {
      max-width: 520px;
      width: 100%;
    }

    /* Panel matches trigger width exactly */
    .cd-panel {
      left: 0 !important;
      right: 0 !important;
      width: 100% !important;
    }

    /* 3) Open UPWARD: anchor bottom to top of trigger */
    .cd-panel {
      top: auto !important;
      bottom: calc(100% + 5px) !important;
      /* shadow flips direction naturally */
      box-shadow: 0 -8px 32px rgba(62,47,28,0.13), 0 -2px 8px rgba(62,47,28,0.06) !important;
      border-radius: var(--radius-md) !important;
    }

    /* Fix animation direction for upward open */
    @keyframes cdSlideIn {
      from { opacity: 0; transform: translateY(8px) scaleY(0.96); }
      to   { opacity: 1; transform: translateY(0) scaleY(1); }
    }

    /* Chevron: rotate UP when open (pointing up means list is above) */
    .cd-trigger.open .cd-arrow {
      transform: rotate(180deg);
    }

    /* Make list taller since no search takes space */
    .cd-list {
      max-height: 260px !important;
      padding: 0.35rem 0 !important;
    }

    @media (max-width: 540px) {
      .city-group {
        max-width: 100% !important;
      }
      .custom-dropdown {
        max-width: 100%;
      }
    }

    /* ================================================================
       FIXES v3 – label alignment, no blue focus, unified backgrounds
       ================================================================ */

    /* 1) LABEL ALIGNMENT – city-group must not add indent
          Remove auto margins that push it away from left-edge alignment.
          The label itself is inside .form-group which already has the right flow.
    ------------------------------------------------------------------ */
    .city-group {
      margin-left: 0 !important;
      margin-right: 0 !important;
    }

    /* The custom-dropdown sits inside .city-group — no extra offset */
    .city-group .custom-dropdown {
      margin: 0;
    }

    /* Labels in every .form-group must share exact same left/right padding — reset any drift */
    .form-group > label,
    .form-group > .field-label {
      display: block;
      padding: 0;
      margin: 0 0 0.3rem 0;
    }

    /* 2) REMOVE BLUE FOCUS / ACTIVE background on all inputs
          Override browser UA styles that paint fields blue/light-blue on focus.
    ------------------------------------------------------------------ */
    .form-group input[type="text"]:focus,
    .form-group input[type="text"]:active,
    .form-group input[type="email"]:focus,
    .form-group input[type="email"]:active,
    .form-group input[type="tel"]:focus,
    .form-group input[type="tel"]:active,
    .form-group input[type="date"]:focus,
    .form-group input[type="date"]:active,
    .form-group select:focus,
    .form-group select:active,
    .form-group textarea:focus,
    .form-group textarea:active,
    .form-input:focus,
    .form-input:active {
      background-color: var(--bg-input-focus) !important;
      background-image: none !important;
      border-color: var(--border-focus) !important;
      box-shadow: 0 0 0 3px rgba(166,124,82,0.13) !important;
      outline: none !important;
      color: var(--text) !important;
      -webkit-text-fill-color: var(--text) !important;
    }

    /* 3) AUTOFILL FIX – Chrome/Safari autofill turns fields yellow/blue.
          Use box-shadow inset trick to paint over the UA-forced background.
    ------------------------------------------------------------------ */
    .form-group input:-webkit-autofill,
    .form-group input:-webkit-autofill:hover,
    .form-group input:-webkit-autofill:focus,
    .form-group input:-webkit-autofill:active,
    .form-input:-webkit-autofill,
    .form-input:-webkit-autofill:hover,
    .form-input:-webkit-autofill:focus,
    .form-input:-webkit-autofill:active {
      -webkit-box-shadow: 0 0 0 9999px var(--bg-input) inset !important;
      box-shadow: 0 0 0 9999px var(--bg-input) inset !important;
      -webkit-text-fill-color: var(--text) !important;
      caret-color: var(--text);
      border-color: var(--border) !important;
      transition: background-color 9999s ease-in-out 0s;
    }

    .form-group input:-webkit-autofill:focus,
    .form-input:-webkit-autofill:focus {
      -webkit-box-shadow: 0 0 0 9999px var(--bg-input-focus) inset, 0 0 0 3px rgba(166,124,82,0.13) !important;
      box-shadow: 0 0 0 9999px var(--bg-input-focus) inset, 0 0 0 3px rgba(166,124,82,0.13) !important;
      border-color: var(--border-focus) !important;
    }

    /* 4) UNIFIED INPUT BACKGROUNDS – all inputs use the same base background
          as the custom dropdown trigger (var(--bg-input)), matching the theme.
    ------------------------------------------------------------------ */
    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="tel"],
    .form-group input[type="date"],
    .form-group select,
    .form-group textarea,
    .form-input {
      background-color: var(--bg-input) !important;
      background-image: none;
      color: var(--text) !important;
    }

    /* Keep the select arrow background-image intact */
    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7' viewBox='0 0 11 7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%23A67C52' stroke-width='1.6' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E") !important;
      background-repeat: no-repeat !important;
      background-position: left 0.9rem center !important;
      background-color: var(--bg-input) !important;
    }

    /* Date input — remove any browser-injected blue tint on calendar icon area */
    .form-group input[type="date"]::-webkit-calendar-picker-indicator {
      opacity: 0.5;
      cursor: pointer;
      filter: sepia(1) saturate(3) hue-rotate(340deg) brightness(0.7);
    }

    /* Placeholder color must stay muted, not inherited from autofill */
    .form-group input::placeholder,
    .form-input::placeholder {
      color: var(--text-muted) !important;
      opacity: 1;
    }

    /* ================================================================
       UNIFIED FIELD WIDTH – v4
       Single source of truth: --field-max = 520px
       Every form-group (label + control) centres at the same width.
       ================================================================ */

    /* form-grid becomes a centred flex column */
    .form-grid {
      align-items: center;   /* centre each .form-group horizontally */
    }

    /* Every form-group obeys --field-max */
    .form-group {
      max-width: var(--field-max);
      width: 100%;
      margin-inline: auto;
    }

    /* Step 2: the file-upload row spans full grid width but still centres */
    .form-group[style*="grid-column"] {
      max-width: var(--field-max) !important;
    }

    /* Summary box in step 4 */
    .summary-box {
      max-width: var(--field-max);
      width: 100%;
      margin-inline: auto;
    }

    /* Dividers should span the same width */
    .divider {
      max-width: var(--field-max);
      width: 100%;
      margin-inline: auto;
    }

    /* City-group: remove the old v2 override's separate max-width;
       it inherits from .form-group above */
    .city-group {
      max-width: var(--field-max) !important;
    }

    /* Custom dropdown wrapper also respects field max */
    .custom-dropdown {
      max-width: 100% !important; /* fills .city-group which is already capped */
    }

    /* Inputs, selects, file-label, cd-trigger all fill their parent */
    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="tel"],
    .form-group input[type="date"],
    .form-group select,
    .form-group textarea,
    .cd-trigger,
    .file-label {
      width: 100% !important;
      max-width: 100% !important;
    }

    /* check-grid and days-grid fill the .form-group */
    .check-grid,
    .days-grid {
      width: 100%;
    }

    /* Responsive: on small screens everything goes full-width naturally */
    @media (max-width: 600px) {
      .form-group,
      .summary-box,
      .divider,
      .city-group {
        max-width: 100% !important;
      }
    }
     
/* ── FOOTER ── */
footer{position:relative;margin-top:32px;background:linear-gradient(180deg,#f5efe5 0%,#f4ead8 18%,#e8d4b4 34%,#d8bc90 50%,#c4a070 64%,#9e7449 78%,#614426 100%);overflow:hidden;}
.footer-dune-bottom{position:absolute;bottom:0;left:0;right:0;height:6px;background:linear-gradient(90deg,#7a5028 0%,#9a6838 18%,#836030 35%,#a87848 52%,#7c5830 68%,#825b39 84%,#6a4623 100%);}
.footer-top-svg{display:block;width:100%;height:70px;position:relative;z-index:2;}
.footer-content{position:relative;z-index:3;max-width:1120px;margin:0 auto;padding:8px 28px 48px;display:grid;grid-template-columns:1.5fr 1fr 1fr;gap:40px;}
.foot-logo{font-family:'Scheherazade New',serif;font-size:1.8rem;font-weight:700;color:rgba(255,255,255,.92);margin-bottom:4px;}
.foot-logo span{font-family:'Tajawal',sans-serif;font-size:.85rem;font-weight:700;letter-spacing:4px;color:rgba(255,255,255,.5);display:block;margin-top:-4px;}
.foot-brand p{font-size:13px;color:rgba(255,255,255,.5);line-height:1.9;margin-top:8px;}
.foot-col h4{font-size:10.5px;letter-spacing:4px;text-transform:uppercase;color:rgba(255,255,255,.42);margin-bottom:14px;font-weight:700;}
.foot-col ul{list-style:none;}
.foot-col ul li{margin-bottom:8px;}
.foot-col ul li a{color:rgba(255,255,255,.6);text-decoration:none;font-size:13px;transition:color .2s;}
.foot-col ul li a:hover{color:#fff;}
.emergency-box{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.14);border-radius:12px;padding:14px;text-align:center;margin-bottom:8px;transition:background .2s;}
.emergency-box:hover{background:rgba(255,255,255,.13);}
.emergency-box .num{font-family:'Scheherazade New',serif;font-size:2rem;color:#fff;line-height:1;}
.emergency-box small{display:block;font-size:10px;letter-spacing:2px;color:rgba(255,255,255,.4);margin-top:3px;text-transform:uppercase;}
.footer-bottom-bar{position:relative;z-index:3;text-align:center;padding:12px 24px 16px;font-size:11px;color:rgba(255,255,255,.25);letter-spacing:2px;border-top:1px solid rgba(255,255,255,.07);}

::-webkit-scrollbar{width:5px;}
::-webkit-scrollbar-track{background:var(--sand-100);}
::-webkit-scrollbar-thumb{background:var(--sand-300);border-radius:3px;}
  </style>

</head>
<body>

  <!-- Accessible live region for screen readers -->
  <div aria-live="polite" aria-atomic="true" class="sr-only" id="liveAnnounce"></div>

  <!-- PAGE HEADER – full width, flat top, curved bottom -->
  <header class="page-header">
    <div class="brand-badge" aria-hidden="true">
      <img src="../assest/New-logo.JPG.jpeg" alt="شعار راصد" />
    </div>
    <div class="brand-text">
      <h1>راصد</h1>
      <p>تسجيل متطوع  </p>
    </div>
  </header>

  <div class="page-wrap">
    <div class="main-card" role="main">

      <!-- ═══════════════════════════════════════
           CARD BODY
           ═══════════════════════════════════════ -->
      <div class="card-body">

        <!-- ─── STEPPER ─────────────────────── -->
        <nav class="stepper" id="stepper" aria-label="مراحل التسجيل">
          <div class="step-item active" data-step="1" aria-current="step">
            <div class="step-circle" id="sc1"><i class="fas fa-user"></i></div>
            <span class="step-label">البيانات</span>
          </div>
          <div class="step-item" data-step="2">
            <div class="step-circle" id="sc2"><i class="fas fa-id-card"></i></div>
            <span class="step-label">الهوية</span>
          </div>
          <div class="step-item" data-step="3">
            <div class="step-circle" id="sc3"><i class="fas fa-star"></i></div>
            <span class="step-label">المهارات</span>
          </div>
          <div class="step-item" data-step="4">
            <div class="step-circle" id="sc4"><i class="fas fa-paper-plane"></i></div>
            <span class="step-label">الإرسال</span>
          </div>
        </nav>

        <!-- ─── STEP COUNTER ──────────────── -->
        <div class="step-counter" aria-live="polite" aria-atomic="true">
          <span class="step-counter-badge">
            <i class="fas fa-circle-dot" style="font-size:0.62rem"></i>
            الخطوة <span id="cStep">1</span> من 4
          </span>
        </div>

        <!-- ─── FORM ──────────────────────── -->
        <form id="regForm" novalidate>

          <!-- ════════════════════════════
               STEP 1 – البيانات الأساسية
               ════════════════════════════ -->
          <div class="step-panel active" id="step1" role="group" aria-labelledby="t1">
            <h2 class="step-title" id="t1" tabindex="-1">البيانات الأساسية</h2>
            <p class="step-subtitle">أدخل معلوماتك الأساسية للتواصل معك.</p>

            <div class="form-grid">

              <!-- الاسم الكامل -->
              <div class="form-group">
                <label for="fullName">الاسم الكامل <span class="req-star" aria-hidden="true">*</span></label>
                <input type="text" id="fullName" name="fullName"
                  placeholder="مثال: محمد عبدالله الغامدي"
                  autocomplete="name"
                  aria-required="true"
                  aria-describedby="e-fullName" />
                <span class="field-error" id="e-fullName" role="alert"></span>
              </div>

              <!-- رقم الجوال -->
              <div class="form-group">
                <label for="phone">رقم الجوال <span class="req-star" aria-hidden="true">*</span></label>
                <input type="tel" id="phone" name="phone"
                  placeholder="05xxxxxxxx"
                  class="ltr"
                  autocomplete="tel"
                  maxlength="10"
                  aria-required="true"
                  aria-describedby="e-phone h-phone" />
                <span class="field-hint" id="h-phone">يبدأ بـ 05 ويتكون من 10 أرقام</span>
                <span class="field-error" id="e-phone" role="alert"></span>
              </div>

              <!-- البريد الإلكتروني -->
              <div class="form-group">
                <label for="email">البريد الإلكتروني <span class="req-star" aria-hidden="true">*</span></label>
                <input type="email" id="email" name="email"
                  placeholder="name@example.com"
                  class="ltr"
                  autocomplete="email"
                  aria-required="true"
                  aria-describedby="e-email" />
                <span class="field-error" id="e-email" role="alert"></span>
              </div>

              <!-- المدينة -->
              <div class="form-group city-group">
                <label for="city">المدينة / المنطقة <span class="req-star" aria-hidden="true">*</span></label>

                <!-- Hidden native select for form value / validation hooks -->
                <select id="city" name="city" aria-required="true" aria-describedby="e-city" tabindex="-1">
                  <option value="" disabled selected>اختر المدينة...</option>
                  <option value="الرياض">الرياض</option>
                  <option value="جدة">جدة</option>
                  <option value="مكة المكرمة">مكة المكرمة</option>
                  <option value="المدينة المنورة">المدينة المنورة</option>
                  <option value="الدمام">الدمام</option>
                  <option value="الأحساء">الأحساء</option>
                  <option value="الطائف">الطائف</option>
                  <option value="تبوك">تبوك</option>
                  <option value="بريدة">بريدة</option>
                  <option value="حائل">حائل</option>
                  <option value="أبها">أبها</option>
                  <option value="نجران">نجران</option>
                  <option value="جيزان">جيزان</option>
                  <option value="القصيم">القصيم</option>
                  <option value="المنطقة الشرقية">المنطقة الشرقية</option>
                  <option value="منطقة أخرى">منطقة أخرى</option>
                </select>

                <!-- Custom dropdown UI -->
                <div class="custom-dropdown" id="cityDropdown" role="combobox" aria-haspopup="listbox"
                     aria-expanded="false" aria-controls="cityList" aria-labelledby="cityDropdownLabel">
                  <button type="button" class="cd-trigger" id="cityTrigger"
                          aria-haspopup="listbox" aria-expanded="false" aria-controls="cityList">
                    <span class="cd-trigger-text" id="cityTriggerText">اختر المدينة...</span>
                    <i class="fas fa-chevron-down cd-arrow" aria-hidden="true"></i>
                  </button>
                  <div class="cd-panel" id="cityPanel" role="listbox" aria-label="قائمة المدن">
                    <div class="cd-list" id="cityList"></div>
                  </div>
                </div>

                <span class="field-error" id="e-city" role="alert"></span>
              </div>

            </div>
          </div><!-- /#step1 -->


          <!-- ════════════════════════════
               STEP 2 – الهوية والتحقق
               ════════════════════════════ -->
          <div class="step-panel" id="step2" role="group" aria-labelledby="t2">
            <h2 class="step-title" id="t2" tabindex="-1">الهوية والتحقق</h2>
            <p class="step-subtitle">يُرجى تعبئة جميع الحقول أدناه للتحقق من هويتك.</p>

            <div class="form-grid">

              <!-- رقم الهوية -->
              <div class="form-group">
                <label for="natId">رقم الهوية / الإقامة <span class="req-star" aria-hidden="true">*</span></label>
                <input type="text" id="natId" name="natId"
                  placeholder="10 أرقام"
                  class="ltr"
                  maxlength="10"
                  aria-required="true"
                  aria-describedby="e-natId" />
                <span class="field-error" id="e-natId" role="alert"></span>
              </div>

              <!-- تاريخ الميلاد -->
              <div class="form-group">
                <label for="dob">تاريخ الميلاد <span class="req-star" aria-hidden="true">*</span></label>
                <input type="date" id="dob" name="dob"
                  aria-required="true"
                  aria-describedby="e-dob" />
                <span class="field-error" id="e-dob" role="alert"></span>
              </div>

              <!-- إرفاق بطاقة/هوية -->
              <div class="form-group" style="grid-column:1/-1">
                <label for="idFile" id="fileLabel">إرفاق بطاقة/هوية <span class="req-star" aria-hidden="true">*</span></label>
                <div class="file-wrap" role="group" aria-labelledby="fileLabel">
                  <label class="file-label" for="idFile">
                    <i class="fas fa-cloud-arrow-up" aria-hidden="true"></i>
                    <span class="file-name" id="fileName">اضغط لاختيار ملف (PDF، JPG، PNG)</span>
                  </label>
                  <input type="file" id="idFile" name="idFile"
                    accept=".pdf,.jpg,.jpeg,.png,application/pdf,image/jpeg,image/png"
                    aria-required="true"
                    aria-describedby="e-file h-file" />
                </div>
                <span class="field-hint" id="h-file">الحد الأقصى للحجم: 5 ميغابايت</span>
                <span class="field-error" id="e-file" role="alert"></span>
              </div>

            </div>
          </div><!-- /#step2 -->


          <!-- ════════════════════════════
               STEP 3 – المهارات والتوفر
               ════════════════════════════ -->
          <div class="step-panel" id="step3" role="group" aria-labelledby="t3">
            <h2 class="step-title" id="t3" tabindex="-1">المهارات والتوفر</h2>
            <p class="step-subtitle">ساعدنا في معرفة مهاراتك وأوقات توفرك — جميع الخيارات اختيارية.</p>

            <div class="form-grid">

              <!-- المهارات -->
              <div class="form-group">
                <p class="field-label">المهارات <span class="opt-badge">(اختر ما ينطبق)</span></p>
                <div class="check-grid">
                  <label class="check-item">
                    <input type="checkbox" name="skills" value="إسعافات أولية" />
                    <span>إسعافات أولية</span>
                  </label>
                  <label class="check-item">
                    <input type="checkbox" name="skills" value="قيادة دفع رباعي" />
                    <span>قيادة دفع رباعي</span>
                  </label>
                  <label class="check-item">
                    <input type="checkbox" name="skills" value="استخدام GPS/خرائط" />
                    <span>استخدام GPS / خرائط</span>
                  </label>
                  <label class="check-item">
                    <input type="checkbox" name="skills" value="خبرة بحث وإنقاذ" />
                    <span>خبرة بحث وإنقاذ</span>
                  </label>
                </div>
              </div>

              <div class="divider"></div>

              <!-- الأيام المتاحة -->
              <div class="form-group">
                <p class="field-label">الأيام المتاحة <span class="opt-badge">(اختياري)</span></p>
                <div class="days-grid">
                  <label class="day-chip"><input type="checkbox" name="days" value="الأحد" /> الأحد</label>
                  <label class="day-chip"><input type="checkbox" name="days" value="الاثنين" /> الاثنين</label>
                  <label class="day-chip"><input type="checkbox" name="days" value="الثلاثاء" /> الثلاثاء</label>
                  <label class="day-chip"><input type="checkbox" name="days" value="الأربعاء" /> الأربعاء</label>
                  <label class="day-chip"><input type="checkbox" name="days" value="الخميس" /> الخميس</label>
                  <label class="day-chip"><input type="checkbox" name="days" value="الجمعة" /> الجمعة</label>
                  <label class="day-chip"><input type="checkbox" name="days" value="السبت" /> السبت</label>
                </div>
              </div>

              <div class="divider"></div>

              <!-- الفترة -->
              <div class="form-group">
                <p class="field-label">الفترة المتاحة <span class="opt-badge">(اختياري)</span></p>
                <div class="check-grid">
                  <label class="check-item">
                    <input type="radio" name="period" value="صباح" />
                    <span><i class="fas fa-sun" style="color:var(--primary-light);margin-left:5px" aria-hidden="true"></i> صباح</span>
                  </label>
                  <label class="check-item">
                    <input type="radio" name="period" value="مساء" />
                    <span><i class="fas fa-moon" style="color:var(--primary);margin-left:5px" aria-hidden="true"></i> مساء</span>
                  </label>
                  <label class="check-item" style="grid-column:1/-1">
                    <input type="radio" name="period" value="طوارئ" />
                    <span><i class="fas fa-bolt" style="color:var(--secondary);margin-left:5px" aria-hidden="true"></i> طوارئ (متاح في أي وقت)</span>
                  </label>
                </div>
              </div>

            </div>
          </div><!-- /#step3 -->


          <!-- ════════════════════════════
               STEP 4 – الإقرار والإرسال
               ════════════════════════════ -->
          <div class="step-panel" id="step4" role="group" aria-labelledby="t4">
            <h2 class="step-title" id="t4" tabindex="-1">الإقرار والإرسال</h2>
            <p class="step-subtitle">راجع بياناتك ثم أقر بصحتها للإرسال.</p>

            <!-- Summary box -->
            <div class="summary-box" id="summaryBox" aria-label="ملخص البيانات المدخلة">
              <div class="summary-title"><i class="fas fa-list-check" aria-hidden="true"></i> ملخص البيانات</div>
              <div id="summaryContent"></div>
            </div>

            <!-- Consents -->
            <div class="form-grid">
              <div class="form-group">
                <label class="consent-item" id="c1wrap">
                  <input type="checkbox" id="consent1" name="consent1"
                    aria-required="true" aria-describedby="e-consent1" />
                  <span>أُقِرُّ بصحة جميع المعلومات المدخلة في هذا النموذج.</span>
                </label>
                <span class="field-error" id="e-consent1" role="alert"></span>
              </div>

              <div class="form-group">
                <label class="consent-item" id="c2wrap">
                  <input type="checkbox" id="consent2" name="consent2"
                    aria-required="true" aria-describedby="e-consent2" />
                  <span>أوافق على سياسة الخصوصية واستخدام بياناتي لأغراض البحث والإنقاذ فقط.</span>
                </label>
                <span class="field-error" id="e-consent2" role="alert"></span>
              </div>
            </div>

          </div><!-- /#step4 -->

          <!-- ─── NAV BUTTONS ─────────────── -->
          <div class="form-nav" id="formNav">
            <button type="button" class="btn-prev" id="btnPrev" disabled aria-label="الخطوة السابقة">
              <i class="fas fa-chevron-right" aria-hidden="true"></i>
              السابق
            </button>
            <button type="button" class="btn-next" id="btnNext">
              التالي
              <i class="fas fa-chevron-left" aria-hidden="true"></i>
            </button>
          </div>

        </form><!-- /#regForm -->

        <!-- ─── SUCCESS PANEL ───────────── -->
        <div class="success-panel" id="successPanel" role="status" aria-live="polite">
          <div class="success-icon" aria-hidden="true">
            <i class="fas fa-check"></i>
          </div>
          <h2 class="success-title">تم إرسال طلب التطوع بنجاح!</h2>
          <p class="success-msg">
            شكرًا لك على انضمامك لمنظومة راصد —<br>
            سيتم مراجعة بياناتك والتواصل معك قريبًا.
          </p>
          <a href="index.html" class="btn-home">
            <i class="fas fa-house" aria-hidden="true"></i>
            العودة للرئيسية
          </a>
        </div>
 </div> <!-- /.card-body -->
  </div>   <!-- /.main-card -->
   </div> <!-- /.page-wrap -->
    
    
<!-- ════ FOOTER ════ -->
  <footer>
    <svg class="footer-top-svg" viewBox="0 0 1440 70" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0,70 L0,32 Q200,0 420,26 Q640,50 860,18 Q1080,0 1280,28 L1440,36 L1440,70 Z" fill="#f9f6f1"/>
      <path d="M0,70 L0,46 Q250,18 500,44 Q750,66 1000,38 Q1250,14 1440,48 L1440,70 Z" fill="#e8d4b4" opacity="0.35"/>
    </svg>
    <div class="footer-content">
      <div class="foot-brand">
        <div class="foot-logo">راصد<span>RASID</span></div>
        <p>منصة وطنية لرصد وتنسيق عمليات البحث والإنقاذ عن المفقودين في البيئات الصحراوية. نعمل على مدار الساعة.</p>
      </div>
      <div class="foot-col">
        <h4>روابط سريعة</h4>
        <ul>
          <li><a href="index.html">الصفحة الرئيسية</a></li>
          <li><a href="login.html">تسجيل الدخول</a></li>
          <li><a href="Regester.html">انضم كمتطوع</a></li>
        </ul>
      </div>
      <div class="foot-col">
        <h4>أرقام الطوارئ</h4>
        <div class="emergency-box"><div class="num">911</div><small>الدفاع المدني</small></div>
        <div class="emergency-box"><div class="num">998</div><small>الهلال الأحمر</small></div>
      </div>
    </div>
    <div class="footer-bottom-bar">جميع الحقوق محفوظة © ٢٠٢٥ &nbsp;|&nbsp; منصة راصد للبحث والإنقاذ</div>
    <div class="footer-dune-bottom"></div>
  </footer>




  <!-- ════════════════════════════════════════════════
       JAVASCRIPT – Modular, RTL-aware, Accessible
       ════════════════════════════════════════════════ -->
  <script>
    'use strict';

    /* ── State ─────────────────────────────────────────── */
    let currentStep = 1;
    const TOTAL     = 4;

    /* ── DOM ────────────────────────────────────────────── */
    const btnPrev      = document.getElementById('btnPrev');
    const btnNext      = document.getElementById('btnNext');
    const formNav      = document.getElementById('formNav');
    const successPanel = document.getElementById('successPanel');
    const liveAnnounce = document.getElementById('liveAnnounce');
    const cStepEl      = document.getElementById('cStep');
    const regForm      = document.getElementById('regForm');

    /* ── Announce helper (screen readers) ──────────────── */
    function announce(msg) {
      liveAnnounce.textContent = '';
      requestAnimationFrame(() => { liveAnnounce.textContent = msg; });
    }

    /* ─────────────────────────────────────────────────────
       showStep(n) – show panel n, update UI
       ───────────────────────────────────────────────────── */
    function showStep(n) {
      /* panels */
      document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
      const panel = document.getElementById('step' + n);
      if (panel) panel.classList.add('active');

      /* counter */
      if (cStepEl) cStepEl.textContent = n;

      /* buttons */
      btnPrev.disabled = n === 1;

      if (n === TOTAL) {
        btnNext.innerHTML = 'إرسال الطلب <i class="fas fa-paper-plane" aria-hidden="true"></i>';
        btnNext.setAttribute('aria-label', 'إرسال طلب التطوع');
      } else {
        btnNext.innerHTML = 'التالي <i class="fas fa-chevron-left" aria-hidden="true"></i>';
        btnNext.setAttribute('aria-label', 'الانتقال للخطوة التالية');
      }

      /* stepper visual */
      updateStepper(n);

      /* announce */
      const titles = { 1: 'البيانات الأساسية', 2: 'الهوية والتحقق', 3: 'المهارات والتوفر', 4: 'الإقرار والإرسال' };
      announce(`الخطوة ${n} من ${TOTAL}: ${titles[n]}`);

      /* focus step title for keyboard users */
      const titleEl = panel?.querySelector('.step-title');
      if (titleEl) { titleEl.setAttribute('tabindex', '-1'); titleEl.focus(); }
    }

    /* ─────────────────────────────────────────────────────
       updateStepper(active)
       ───────────────────────────────────────────────────── */
    function updateStepper(active) {
      const icons = { 1:'fas fa-user', 2:'fas fa-id-card', 3:'fas fa-star', 4:'fas fa-paper-plane' };

      document.querySelectorAll('.step-item').forEach(item => {
        const s = parseInt(item.dataset.step, 10);
        const circle = item.querySelector('.step-circle');

        item.classList.remove('active', 'completed');
        item.removeAttribute('aria-current');

        if (s === active) {
          item.classList.add('active');
          item.setAttribute('aria-current', 'step');
          circle.innerHTML = `<i class="${icons[s]}" aria-hidden="true"></i>`;
        } else if (s < active) {
          item.classList.add('completed');
          circle.innerHTML = '<i class="fas fa-check" aria-hidden="true"></i>';
        } else {
          circle.innerHTML = `<i class="${icons[s]}" aria-hidden="true"></i>`;
        }
      });
    }

    /* ─────────────────────────────────────────────────────
       Validation helpers
       ───────────────────────────────────────────────────── */
    const RE_EMAIL = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    const RE_PHONE = /^05\d{8}$/;

    function setErr(el, errId, msg) {
      const errEl = document.getElementById(errId);
      if (!el || !errEl) return;
      errEl.textContent = msg;
      if (msg) {
        el.classList.add('is-invalid');
        el.setAttribute('aria-invalid', 'true');
      } else {
        el.classList.remove('is-invalid');
        el.setAttribute('aria-invalid', 'false');
      }
    }

    function setConsentErr(wrapId, errId, msg) {
      const errEl = document.getElementById(errId);
      const wrap  = document.getElementById(wrapId);
      if (!errEl) return;
      errEl.textContent = msg;
      if (msg) wrap?.classList.add('is-invalid');
      else     wrap?.classList.remove('is-invalid');
    }

    /* ─────────────────────────────────────────────────────
       validateStep(n) – validate current step, return bool
       ───────────────────────────────────────────────────── */
    function validateStep(n) {
      let ok = true;

      if (n === 1) {
        const name  = document.getElementById('fullName');
        const phone = document.getElementById('phone');
        const email = document.getElementById('email');
        const city  = document.getElementById('city');

        /* name */
        if (!name.value.trim() || name.value.trim().length < 2) {
          setErr(name, 'e-fullName', 'الرجاء إدخال الاسم الكامل (حرفان على الأقل).'); ok = false;
        } else { setErr(name, 'e-fullName', ''); }

        /* phone */
        const pv = phone.value.trim().replace(/\s/g,'');
        if (!pv) {
          setErr(phone, 'e-phone', 'الرجاء إدخال رقم الجوال.'); ok = false;
        } else if (!RE_PHONE.test(pv)) {
          setErr(phone, 'e-phone', 'رقم الجوال غير صحيح. مثال: 0512345678'); ok = false;
        } else { setErr(phone, 'e-phone', ''); }

        /* email */
        const ev = email.value.trim();
        if (!ev) {
          setErr(email, 'e-email', 'الرجاء إدخال البريد الإلكتروني.'); ok = false;
        } else if (!RE_EMAIL.test(ev)) {
          setErr(email, 'e-email', 'الرجاء إدخال بريد إلكتروني صحيح.'); ok = false;
        } else { setErr(email, 'e-email', ''); }

        /* city */
        if (!city.value) {
          setErr(city, 'e-city', 'الرجاء اختيار المدينة أو المنطقة.'); ok = false;
          const t = document.getElementById('cityTrigger');
          if (t) t.classList.add('is-invalid');
        } else {
          setErr(city, 'e-city', '');
          const t = document.getElementById('cityTrigger');
          if (t) t.classList.remove('is-invalid');
        }

        if (!ok) {
          const first = document.querySelector('#step1 .is-invalid');
          if (first) first.focus();
        }
      }

      else if (n === 2) {
        const natId    = document.getElementById('natId');
        const dob      = document.getElementById('dob');
        const fileInput = document.getElementById('idFile');

        /* رقم الهوية – required, 10 digits */
        const nv = natId.value.trim();
        if (!nv) {
          setErr(natId, 'e-natId', 'الرجاء إدخال رقم الهوية أو الإقامة.'); ok = false;
        } else if (!/^\d{10}$/.test(nv)) {
          setErr(natId, 'e-natId', 'رقم الهوية يجب أن يتكون من 10 أرقام بالضبط.'); ok = false;
        } else { setErr(natId, 'e-natId', ''); }

        /* تاريخ الميلاد – required */
        if (!dob.value) {
          setErr(dob, 'e-dob', 'الرجاء تحديد تاريخ الميلاد.'); ok = false;
        } else { setErr(dob, 'e-dob', ''); }

        /* الملف – required, max 5MB */
        const errFileEl = document.getElementById('e-file');
        if (fileInput.files.length === 0) {
          errFileEl.textContent = 'الرجاء إرفاق صورة الهوية أو الإقامة.';
          fileInput.closest('.file-wrap').querySelector('.file-label').style.borderColor = 'var(--error-border)';
          ok = false;
        } else if (fileInput.files[0].size > 5 * 1024 * 1024) {
          errFileEl.textContent = 'حجم الملف يتجاوز الحد الأقصى المسموح (5 ميغابايت).';
          ok = false;
        } else {
          errFileEl.textContent = '';
          fileInput.closest('.file-wrap').querySelector('.file-label').style.borderColor = '';
        }

        if (!ok) {
          const first = document.querySelector('#step2 .is-invalid');
          if (first) first.focus();
        }
      }

      /* step 3: optional — always valid */

      else if (n === 4) {
        const c1 = document.getElementById('consent1');
        const c2 = document.getElementById('consent2');

        if (!c1.checked) {
          setConsentErr('c1wrap', 'e-consent1', 'يجب الإقرار بصحة المعلومات للمتابعة.'); ok = false;
        } else { setConsentErr('c1wrap', 'e-consent1', ''); }

        if (!c2.checked) {
          setConsentErr('c2wrap', 'e-consent2', 'يجب الموافقة على سياسة الخصوصية للمتابعة.'); ok = false;
        } else { setConsentErr('c2wrap', 'e-consent2', ''); }

        if (!ok) document.getElementById('consent1').focus();
      }

      return ok;
    }

    /* ─────────────────────────────────────────────────────
       collectSummary() – populate read-only summary in step 4
       ───────────────────────────────────────────────────── */
    function collectSummary() {
      const g   = id => (document.getElementById(id)?.value || '').trim();
      const skills = Array.from(document.querySelectorAll('input[name="skills"]:checked'))
                         .map(el => el.value).join('، ') || 'لم تُحدَّد';
      const days   = Array.from(document.querySelectorAll('input[name="days"]:checked'))
                         .map(el => el.value).join('، ') || 'لم تُحدَّد';
      const period = document.querySelector('input[name="period"]:checked')?.value || 'لم تُحدَّد';

      const rows = [
        { k: 'الاسم الكامل',       v: g('fullName') || '—' },
        { k: 'رقم الجوال',          v: g('phone')    || '—' },
        { k: 'البريد الإلكتروني',   v: g('email')    || '—' },
        { k: 'المدينة',              v: g('city')     || '—' },
        { k: 'المهارات',             v: skills },
        { k: 'الأيام المتاحة',       v: days },
        { k: 'الفترة',               v: period },
      ];

      document.getElementById('summaryContent').innerHTML =
        rows.map(r =>
          `<div class="summary-row">
             <span class="s-key">${r.k}</span>
             <span class="s-val">${r.v}</span>
           </div>`
        ).join('');
    }

    /* ─────────────────────────────────────────────────────
       File input – show name & validate size instantly
       ───────────────────────────────────────────────────── */
    document.getElementById('idFile')?.addEventListener('change', function () {
      const display = document.getElementById('fileName');
      const errEl   = document.getElementById('e-file');
      if (this.files.length) {
        const f = this.files[0];
        display.textContent = f.name;
        if (f.size > 5 * 1024 * 1024) {
          errEl.textContent = 'حجم الملف يتجاوز الحد الأقصى المسموح (5 ميغابايت).';
        } else {
          errEl.textContent = '';
        }
      } else {
        display.textContent = 'اضغط لاختيار ملف (PDF، JPG، PNG)';
        errEl.textContent = '';
      }
    });

    /* ─────────────────────────────────────────────────────
       Date max = today
       ───────────────────────────────────────────────────── */
    const dobEl = document.getElementById('dob');
    if (dobEl) dobEl.max = new Date().toISOString().split('T')[0];

    /* ─────────────────────────────────────────────────────
       NEXT button
       ───────────────────────────────────────────────────── */
    btnNext.addEventListener('click', () => {
      if (!validateStep(currentStep)) return;

      if (currentStep === TOTAL) {
        handleSubmit();
        return;
      }

      currentStep++;
      if (currentStep === TOTAL) collectSummary();
      showStep(currentStep);
    });

    /* ─────────────────────────────────────────────────────
       PREV button
       ───────────────────────────────────────────────────── */
    btnPrev.addEventListener('click', () => {
      if (currentStep > 1) {
        currentStep--;
        showStep(currentStep);
      }
    });

    /* ─────────────────────────────────────────────────────
       handleSubmit() – success state
       ───────────────────────────────────────────────────── */
    function handleSubmit() {
      regForm.style.display  = 'none';
      formNav.style.display  = 'none';
      document.querySelector('.stepper').style.display       = 'none';
      document.querySelector('.step-counter').style.display  = 'none';

      successPanel.classList.add('visible');
      announce('تم إرسال طلب التطوع بنجاح! سيتم التواصل معك قريبًا.');
    }

    /* ─────────────────────────────────────────────────────
       Keyboard: Enter on inputs advances step
       ───────────────────────────────────────────────────── */
    regForm.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        const tag  = e.target.tagName.toLowerCase();
        const type = e.target.type;
        if (tag === 'input' && type !== 'checkbox' && type !== 'radio') {
          e.preventDefault();
          btnNext.click();
        }
      }
    });

    /* ─────────────────────────────────────────────────────
       Custom City Dropdown – RTL select-only (no search)
       ───────────────────────────────────────────────────── */
    (function initCityDropdown() {
      const citySelect  = document.getElementById('city');
      const trigger     = document.getElementById('cityTrigger');
      const triggerText = document.getElementById('cityTriggerText');
      const panel       = document.getElementById('cityPanel');
      const listEl      = document.getElementById('cityList');
      const errEl       = document.getElementById('e-city');
      const wrapper     = document.getElementById('cityDropdown');

      // Gather options from the hidden select
      const cities = Array.from(citySelect.options)
        .filter(o => o.value !== '')
        .map(o => o.value);

      let focusedIdx = -1;
      let isOpen = false;

      /* Build option elements */
      function buildList() {
        listEl.innerHTML = '';
        focusedIdx = -1;

        cities.forEach((city) => {
          const opt = document.createElement('div');
          const isSel = city === citySelect.value;
          opt.className = 'cd-option' + (isSel ? ' selected' : '');
          opt.textContent = city;
          opt.setAttribute('role', 'option');
          opt.setAttribute('data-value', city);
          opt.setAttribute('aria-selected', isSel ? 'true' : 'false');
          opt.addEventListener('mousedown', e => {
            e.preventDefault();
            selectCity(city);
          });
          listEl.appendChild(opt);
        });
      }

      /* Select a city */
      function selectCity(val) {
        citySelect.value = val;
        triggerText.textContent = val;
        trigger.classList.add('has-value');
        trigger.classList.remove('is-invalid');
        wrapper.classList.remove('is-invalid');
        if (errEl) errEl.textContent = '';
        closePanel();
        trigger.focus();
        buildList(); // update selected highlight
      }

      /* Open */
      function openPanel() {
        isOpen = true;
        buildList();
        panel.classList.add('open');
        trigger.classList.add('open');
        trigger.setAttribute('aria-expanded', 'true');
        wrapper.setAttribute('aria-expanded', 'true');
        // Find index of current selection
        const opts = listEl.querySelectorAll('.cd-option');
        focusedIdx = -1;
        opts.forEach((o, i) => {
          if (o.classList.contains('selected')) focusedIdx = i;
        });
        // Highlight & scroll to selected
        requestAnimationFrame(() => {
          if (focusedIdx >= 0) {
            setFocused(focusedIdx);
          }
        });
      }

      /* Close */
      function closePanel() {
        isOpen = false;
        panel.classList.remove('open');
        trigger.classList.remove('open');
        trigger.setAttribute('aria-expanded', 'false');
        wrapper.setAttribute('aria-expanded', 'false');
        focusedIdx = -1;
        // Clear focused highlights
        listEl.querySelectorAll('.cd-option.focused').forEach(o => o.classList.remove('focused'));
      }

      /* Highlight a focused option */
      function setFocused(idx) {
        const opts = listEl.querySelectorAll('.cd-option');
        opts.forEach((o, i) => o.classList.toggle('focused', i === idx));
        if (opts[idx]) opts[idx].scrollIntoView({ block: 'nearest' });
        focusedIdx = idx;
      }

      /* Trigger click */
      trigger.addEventListener('click', () => {
        isOpen ? closePanel() : openPanel();
      });

      /* Keyboard on trigger */
      trigger.addEventListener('keydown', e => {
        const opts = listEl.querySelectorAll('.cd-option');
        if (!isOpen) {
          if (e.key === 'Enter' || e.key === ' ' || e.key === 'ArrowDown' || e.key === 'ArrowUp') {
            e.preventDefault();
            openPanel();
          }
          return;
        }
        // Panel is open — navigate
        if (e.key === 'ArrowDown') {
          e.preventDefault();
          setFocused(Math.min(focusedIdx + 1, opts.length - 1));
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          setFocused(Math.max(focusedIdx - 1, 0));
        } else if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          if (focusedIdx >= 0 && opts[focusedIdx]) {
            selectCity(opts[focusedIdx].dataset.value);
          }
        } else if (e.key === 'Escape' || e.key === 'Tab') {
          if (e.key === 'Escape') e.preventDefault();
          closePanel();
        }
      });

      /* Click outside closes */
      document.addEventListener('mousedown', e => {
        if (isOpen && !wrapper.contains(e.target)) closePanel();
      });

      /* Expose invalid state for validation */
      citySelect.addEventListener('invalid', () => {
        trigger.classList.add('is-invalid');
      });

      /* Initial build */
      buildList();

      /* Expose for external use */
      window._cityDropdown = { openPanel, closePanel, selectCity };
    })();

    /* ─────────────────────────────────────────────────────
       Init
       ───────────────────────────────────────────────────── */
    showStep(1);
  </script>

</body>
</html>